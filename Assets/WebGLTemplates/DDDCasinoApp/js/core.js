let iframe,origin,coin_type,music,sound,settings_type,mobile,lobbyAlias,version,serverUrl,bingoCompleted=!1,accessToken,wakeLock=null;async function requestWakeLock(){try{wakeLock=await navigator.wakeLock.request("screen"),console.log("Wake Lock is active.")}catch(e){console.error(e.name+", "+e.message)}}function releaseWakeLock(){null!==wakeLock&&wakeLock.release().then(()=>{wakeLock=null,console.log("Wake Lock released.")})}function loadJSON(e,o){var n=new XMLHttpRequest;n.open("GET",e,!0),n.responseType="json",n.onload=function(){200===n.status?o(null,n.response):o(n.status)},n.send()}function applySettings(){switch(settings_type){case"k2HD7dhg":settingsPath="../../settings_dev.json";break;case"DHEYw7dhg":settingsPath="../../settings_stage.json";break;default:settingsPath="../../settings_prod.json"}loadJSON(settingsPath,(e,o)=>{e?console.log("Error loading JSON file"):(origin=o.domen,lobbyAlias=o.lobby_alias,version=o.version,serverUrl=o.serverUrl)})}function setCookie(e,o,n={}){(n={path:"/",...n}).expires instanceof Date&&(n.expires=n.expires.toUTCString());let i=encodeURIComponent(e)+"="+encodeURIComponent(o);for(var s in n){i+="; "+s;s=n[s];!0!==s&&(i+="="+s)}document.cookie=i}function deleteCookie(e){setCookie(e,"",{expires:"Thu, 01 Jan 1970 00:00:00 UTC"})}function getCookie(e){for(var o=document.cookie.split(";"),n=0;n<o.length;n++){var i=o[n].split("=");if(e==i[0].trim())return decodeURIComponent(i[1])}}function logout(){window.localStorage.removeItem("AccessToken"),window.localStorage.removeItem("RefreshToken"),deleteCookie("AccessToken"),deleteCookie("RefreshToken"),redirect()}function redirect(e=""){window.unityInstance.Quit(),window.unityInstance=null,"1"==iframe?("map"==e?e="/?show=allrewards":"challenges"==e?e="/?show=challenges":"rewards"==e?e="/?show=rewards":"deals"==e?e="/?show=deals-shop":"panda"==e?e="/?show=add-pet&kind=panda":"pony"==e?e="/?show=add-pet&kind=pony":"cat"==e?e="/?show=add-pet&kind=cat":"elephant"==e?e="/?show=add-pet&kind=elephant":"fox"==e?e="/?show=add-pet&kind=fox":"kangaroo"==e?e="/?show=add-pet&kind=kangaroo":"rabbit"==e?e="/?show=add-pet&kind=rabbit":"lion"==e?e="/?show=add-pet&kind=lion":"penguin"==e&&(e="/?show=add-pet&kind=penguin"),sendMessageToLobby("redirect",e)):(link=""==e?origin:"lobby"==e?`${origin}/${lobbyAlias}/`:"challenges"==e?`${origin}/${lobbyAlias}/?show=challenges`:"rewards"==e?`${origin}/${lobbyAlias}/?show=rewards`:"map"==e?`${origin}/${lobbyAlias}/?show=allrewards`:"deals"==e?`${origin}/${lobbyAlias}/?show=deals-shop`:"panda"==e?`${origin}/${lobbyAlias}/?show=add-pet&kind=panda`:"pony"==e?`${origin}/${lobbyAlias}/?show=add-pet&kind=pony`:"cat"==e?`${origin}/${lobbyAlias}/?show=add-pet&kind=cat`:"elephant"==e?`${origin}/${lobbyAlias}/?show=add-pet&kind=elephant`:"fox"==e?`${origin}/${lobbyAlias}/?show=add-pet&kind=fox`:"kangaroo"==e?`${origin}/${lobbyAlias}/?show=add-pet&kind=kangaroo`:"rabbit"==e?`${origin}/${lobbyAlias}/?show=add-pet&kind=rabbit`:"lion"==e?`${origin}/${lobbyAlias}/?show=add-pet&kind=lion`:"penguin"==e?`${origin}/${lobbyAlias}/?show=add-pet&kind=penguin`:`${origin}/${lobbyAlias}/${e}/`,window.location=link)}function growPet(e){redirect(e)}function refresh(){location.reload(!0)}function goToLobby(){redirect("lobby")}function goToBingo(){goToGame("bingo")}function goToDeals(){redirect("deals")}function goToShop(){redirect("shop")}function goToMap(){redirect("map")}function goToChallenges(){redirect("challenges")}function goToRewards(){redirect("rewards")}function goToFacebook(){redirect("facebook")}function setOrigin(e){origin=e}function setMusic(e){sendMessageToLobby("music",music=e)}function setSound(e){sendMessageToLobby("sound",sound=e)}function setBingoCompleted(){bingoCompleted=!0}function setBingoStarted(){bingoCompleted=!1}function goToGame(e){var o,n;"1"==iframe?sendMessageToLobby("change-game",e):(o="1"==mobile?"_mobile":"",n=`?coin_type=${coin_type}&music=${music}&sound=${sound}&settings_type=`+settings_type,e=`${origin}/games/${version}/${e}${o}/`+n,window.open(e,"_self"))}function sendMessageToLobby(e,o){window.parent.postMessage(JSON.stringify({eventType:e,value:o}),origin)}requestWakeLock(),setInterval(()=>{document.activeElement.blur(),document.activeElement.focus()},1e4),document.addEventListener("DOMContentLoaded",()=>{var e=new URLSearchParams(window.location.search);iframe=e.get("iframe"),coin_type=e.get("coin_type"),music=e.get("music"),sound=e.get("sound"),settings_type=e.get("settings_type"),mobile=e.get("mobile"),accessToken=getCookie("AccessToken"),applySettings()}),document.addEventListener("visibilitychange",function(){"visible"===document.visibilityState&&unityInstance.SendMessage("Reloader","RefreshOnVisibilityChange")}),window.addEventListener("pagehide",()=>{var e;console.log("url: "+serverUrl+"/game/bingo/end"),bingoCompleted&&(console.log("aToken: "+accessToken),e={type:"application/json",authorization:accessToken},e=new Blob([],e),navigator.sendBeacon(serverUrl+"/game/bingo/end",e))});