document.addEventListener("DOMContentLoaded",()=>{let r="credit-card-popup",p="VISA",E="AMEX",v="MASTERCARD",m="DISCOVER",f="DINERS",y="JCB",g="CHINA_UNION_PAY",a=JSON.parse(JSON.stringify([p,E,v,m,y,g]).toLocaleLowerCase()),n=document.querySelector("#"+r),c=document.querySelector("#credit-card-f-name"),o=document.querySelector("#credit-card-l-name"),d=document.querySelector("#credit-card-number"),l=document.querySelector("#credit-card-exp-date"),s=document.querySelector("#credit-card-cvc"),i=document.querySelector("#credit-card-zip");var e=document.querySelector("#save-credit-card-btn"),t=document.querySelector("#close-card-modal-btn");checkFormValidity(n,e);{let r=[c,o,d,l,i,s];r.forEach((e,t)=>{e.addEventListener("keydown",e=>{t!==r.length-1&&(r[t+1].style.border="2px solid #00c2ff")}),e.addEventListener("focus",()=>{e.style.borderColor="#ffffff"})})}function u(e){var e=e.split(" ").join(""),t=new RegExp("^3[47][0-9]{13}$"),r=new RegExp("^4[0-9]{12}(?:[0-9]{3})?$"),a=new RegExp("^62[0-9]{14}[0-9]*$"),n=new RegExp("^81[0-9]{14}[0-9]*$"),c=new RegExp("^5[1-5][0-9]{14}$"),o=new RegExp("^2[2-7][0-9]{14}$"),d=new RegExp("^6011[0-9]{12}[0-9]*$"),l=new RegExp("^62[24568][0-9]{13}[0-9]*$"),s=new RegExp("^6[45][0-9]{14}[0-9]*$"),i=new RegExp("^3[0689][0-9]{12}[0-9]*$"),u=new RegExp("^35[0-9]{14}[0-9]*$");return r.test(e)?p:t.test(e)?E:c.test(e)||o.test(e)?v:d.test(e)||l.test(e)||s.test(e)?m:i.test(e)?f:u.test(e)?y:a.test(e)||n.test(e)?g:void 0}String.prototype.toCardFormat=function(){return this?.replace(/[^0-9]/g,"").substr(0,16).split("").reduce(function(e,t,r){return e+(!r||r%4?"":" ")+t},"")};{let t;d.addEventListener("keyup",()=>{d.value=d?.value?.toCardFormat(),t=u(d.value);var e=Array.from(d.parentElement.classList).find(e=>a.includes(e));d.value.length<6&&(d.parentElement.classList.remove(e?.toLocaleLowerCase()),t=void 0),t&&d.parentElement.classList.add(t.toLocaleLowerCase())})}e.addEventListener("click",function(){var e=[c,o,d,l,s,i],t=[...e].every(e=>!!e.value);e.forEach(e=>{checkTextFieldForEmpty(e)}),t&&(e=l.value?.replace("/",""),t=d.value.split(" ").join(""),t=`{
            'firstName':'${c.value}',
            'lastName':'${o.value}',
            'cardNumber':'${t}',
            'cardExpiration':'${e}',
            'cardCVC':'${s.value}',
            'zip':'${i.value}'
        }`,console.log("js: "+t),hidePopup(r),window.unityInstance.SendMessage("Application","ProcessCreditCardDetails",t),clearModalValues(n))}),t.addEventListener("click",function(){clearModalValues(n),hidePopup(r),window.unityInstance.SendMessage("Application","ProcessCreditCardDetails","")})});